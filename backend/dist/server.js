!function(e){var t={};function o(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=7)}([function(e,t){e.exports=require("querystring")},function(e,t){e.exports=require("request")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=o(0);!function(e){const t="1ba80100e92d4d49870b7e4fc4931720",o="3da3164990b4482dbdeb3bc941a07466",r="http://localhost:3000/redirect";e.spotifyStateKey="spotify_auth_state",e.giveState=function(e){let t="",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<e;i++)t+=o.charAt(Math.floor(Math.random()*o.length));return t},e.connexion=function(e,o,n){e.redirect("https://accounts.spotify.com/authorize?"+i.stringify({response_type:"code",client_id:t,scope:o,redirect_uri:r,state:n}))},e.authentificationOptions=function(e){return{url:"https://accounts.spotify.com/api/token",form:{code:e,redirect_uri:r,grant_type:"authorization_code"},headers:{Authorization:"Basic "+new Buffer(t+":"+o).toString("base64")},json:!0}}}(t.SpotifyConfig||(t.SpotifyConfig={}))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=o(2),r=o(0),n=o(1);!function(e){e.spotify_login=function(e,t){let o=i.SpotifyConfig.giveState(16);t.cookie(i.SpotifyConfig.spotifyStateKey,o),i.SpotifyConfig.connexion(t,"user-read-private user-read-email",o)},e.spotify_redirect=function(e,t){let o=e.query.code||null,s=e.query.state||null,c=e.cookies?e.cookies[i.SpotifyConfig.spotifyStateKey]:null;if(null===s||s!==c)t.redirect("/#"+r.stringify({error:"state_mismatch"}));else{t.clearCookie(i.SpotifyConfig.spotifyStateKey);let e=i.SpotifyConfig.authentificationOptions(o);n.post(e,function(e,o,i){if(e||200!==o.statusCode)t.redirect("/#"+r.stringify({error:"invalid_token"}));else{var s=i.access_token,c=(i.refresh_token,{url:"https://api.spotify.com/v1/me",headers:{Authorization:"Bearer "+s},json:!0});n.get(c,function(e,o,i){return t.json({data:i})})}})}}}(t.HelperSpotify||(t.HelperSpotify={}))},function(e,t){e.exports=require("cookie-parser")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("express")},function(e,t,o){"use strict";(function(i){Object.defineProperty(t,"__esModule",{value:!0});const r=o(6),n=o(5),s=o(4),c=o(3),u=r();u.set("port",process.env.PORT||3e3),u.use(n.json()),u.use(n.urlencoded({extended:!0})),u.use(r.static(i+"/public")).use(s()),u.get("/spotify-login",c.HelperSpotify.spotify_login),u.get("/spotify-redirect",c.HelperSpotify.spotify_redirect),u.listen(u.get("port"),()=>{console.log("App is running at http://localhost:%d",u.get("port")),console.log("Press CTRL-C to stop\n")}),e.exports=u}).call(this,"/")}]);